# Программа оптимизации уставок ТЗНП
Программа оптимизации токовых защит нулевой последовательности. 

Анализирует и и оценивает срабатывание защит в множестве подрежимов сети и использует алгоритм оптимизации для подбора уставок.





![image](https://github.com/user-attachments/assets/e6c79a98-35b9-494a-b71e-4c00dff67761)
Общая структура оптимизации

## Функционал программы
Программа разделена на несколько страниц (Сеть, Подрежимы, Оптимизация, Анализ)
### Сеть
Страница сеть используется для создания модели сети, объекты сети добавляются и удаляются в табличном виде, затем выводятся в таблице и на схеме сети. Также для демонстрации возможнойтей программы добавлена кнопка Тестовая модель
![image](https://github.com/user-attachments/assets/fbd5127f-3512-4a2a-9b12-60831efa9c90)

### Подрежимы
Страница подрежимы содержит "калькулятор подрежимов", который на основании задания в виде псевдокода создает словарь подрежимов, который  используется в дальнейшем для  оптимизации и анализа. Функции псевдокода выведены отдельными кнопками, а также для удобства представлена уменьшенная схема сети. Также возможно оценить скорость одного просчета целевой функции.
![image](https://github.com/user-attachments/assets/c89d2b61-f0e9-4cd4-910e-731b2b1e2ac7)

### Оптимизация
Страница оптимизация предназначенна для настройки параметров оптимизации и собственно оптимизации. Возможно настроить веса ошибок, коэфициенты защит, количество итераций оптимизации и количество оптимизируемых защит. 
В процессе оптимизации строится график ошибки и выводится лог оптимизации.
![image](https://github.com/user-attachments/assets/ef71c90d-d266-47b1-b287-3be33869c71c)

### Анализ
Страница анализ предназначается для анализа оставшихся после оптимизации нежелательных срабатываний (напрммер неселективных), и последующей ручной подстройки уставок, а также оценки текущих уставок в различных наборах подрежимов. На данном листе выводится таблица подрежимов с нежелательными срабатываниями, при нажатии на подрежим, выводится визуализация в виде схем сети порядка отключения линий. Кнопками вперед-назад можно смотреть шаг за шагом как отключались линии. Также на листе есть таблица с уставками защит, при двойном нажатии на уставку, возможно ее отредактировать. После нажатия кнопки Пересчет срабатывания будут перерасчитаны с новыми уставками.
![image](https://github.com/user-attachments/assets/91675d8b-32f9-4364-abd5-9e2aa79edded)

## Ограничения
**На данный момент программа выполненна для упрощенной задачи с рядом допущений.**
- Реализована оптимизация только направленных ТЗНП
- Орган направления мощности обладает бесконечной чувствительностью и срабатывает фиксированно в секторе 160'-340'
- Коэффициенты отстройки и чувствительности учтены не во всех частях алгоритма
- Не реализованна сущность объект, объеденяющая несколько ветвей
- Не реализован импорт из АРМ
- Не реализованно добавление взаимоиндукций из GUI
- Не реализованно добавление различной автоматики, вроде телеускорения, АПВ, УРОВ


## Файлы
- GUI.py - код GUI программы
- mrtkz3.py - модификация библиотеки mrtkz3 (https://github.com/aspirmk/mrtkz)
- kar_mrtkz.py - функции для работы с моделью сети
- kar_analyse.py - функции для анализа и оценки страбатываний защит
- kar_optimisation_pypeline.py - функции оптимизации защит

